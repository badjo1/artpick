<div class="admin-container">
  <div class="admin-header">
    <h1>Exhibition Media</h1>
    <div class="admin-header-actions">
      <%= link_to "â† Back to Exhibition", admin_exhibition_path(@exhibition), class: "btn btn-secondary" %>
      <%= link_to "+ Upload Media", new_admin_exhibition_exhibition_medium_path(@exhibition), class: "btn btn-primary" %>
    </div>
  </div>

  <% if @exhibition_media.any? %>
    <div class="media-grid">
      <% @exhibition_media.each do |medium| %>
        <div class="media-card">
          <% if medium.file.attached? %>
            <% if medium.file.content_type.start_with?("video") %>
              <%= video_tag url_for(medium.file), controls: true, preload: "metadata", class: "media-image" %>
            <% else %>
              <%= image_tag medium.file, class: "media-image", alt: medium.caption || "Exhibition photo" %>
            <% end %>
          <% end %>

          <div class="media-info">
            <% if medium.caption.present? %>
              <p class="media-caption"><%= medium.caption %></p>
            <% end %>

            <% if medium.photographer.present? %>
              <p class="media-photographer text-secondary">Photo by <%= medium.photographer %></p>
            <% end %>

            <% if medium.position.present? %>
              <p class="media-position text-secondary">Position: <%= medium.position %></p>
            <% end %>
          </div>

          <div class="media-actions">
            <%= link_to "Edit", edit_admin_exhibition_exhibition_medium_path(@exhibition, medium), class: "btn btn-secondary" %>

            <!-- Direct delete form for testing -->
            <%= button_to "Delete",
                admin_exhibition_exhibition_medium_path(@exhibition, medium),
                method: :delete,
                form: { data: { turbo_confirm: "Are you sure you want to delete this media?" } },
                class: "btn btn-danger" %>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <div class="empty-state">
      <p>No media uploaded yet.</p>
      <%= link_to "Upload Media", new_admin_exhibition_exhibition_medium_path(@exhibition), class: "btn btn-primary" %>
    </div>
  <% end %>
</div>
